Carácteres con su código: 

: 10011
 : 11
": 00000100
': 0011101010
(: 00001
): 00100
*: 10110100
+: 00111011
,: 001111
-: 01111111
.: 100100
/: 00111000110
0: 10000100
1: 0011010
2: 0011101011
4: 0101010110110
6: 0101010110111
9: 001110001000
:: 001100
<: 010101010
=: 010100
>: 00111000111
A: 00111010000
B: 001110010
C: 001110001001
D: 00111010001
E: 10000101000
F: 000001010
G: 0101010111
I: 10110101
L: 0011100000
M: 000001011
N: 1000010101
O: 100001011
R: 00111010010
S: 10000101001
T: 001110011
U: 0011100001
W: 0111111000
Z: 01111110010
[: 1001010
\: 01111110011
]: 1001011
^: 001110001010
_: 1011011
a: 01000
b: 1000011
c: 000000
d: 100000
e: 0110
f: 10100
g: 0000011
h: 0011011
i: 10101
k: 01111101
l: 01110
m: 011110
n: 01001
o: 00101
p: 01011
q: 00111010011
r: 0001
s: 10111
t: 10001
u: 101100
v: 01111100
w: 0101011
x: 011111101
y: 01010100
z: 01010101100
{: 001110001011
}: 010101011010

Código Huffman: 
101011010011001110011000110110001100011001001111111111101000001001010111101110101001011110101011110010110010100011000111001110010010101001000101101011110110101100001011001111111011010110000101100111001001000101110110100111111111110101011110010110010100011000111011110010001000100110111001110011111111111010101111001011001010001100011100010100001001100000001010111101001111111111101010111100101100101000110001111011101010100101111001111111111101010111100101100101000110001110010110111100111001111111111101010111100101100101000110001111000011101011011101100000001000110011111111111010101111001011001010001100011110001010101000101110101010010000011100111111111110100000100101011110110000000010101110011100110000000100011010100101010011011111101010111100101100101000110001110011100010010010110110001001100010110000100111111100000011010100010001011000111010001100000101010000001000100111111100000011000111010011101100011010011111111111010000010010101111011000000001010101101010100111010101111001011001010001100011110000001100110010110000000010101011010101001001111111111101000001001010111101110100101100010010000001000100101001010111010111111010101111001011001010001100011100000001111001011101101110001001011011011011111010110010101000011111101110000110110010110110000000100000000000110110110001111110001011010000010110000000001101001111111111101000001001010111101100110110110010000101100111010011111010101111001011001010001100011100110110110010000101110101101000101010000111111001101101100100001011010110010101011001111110011011011001000010110101110110010111001101100111111001101101100100001011010111011001011100110110101100101010110011111101001011100100000010000011011010111100010011111101001101110111100100001110011100110101111000110011111111111010000010010101111011101011000101100001100010010100101011101011111101010111100101100101000110001110100000000000000010110001111010110001110010001000101100011111100000000101011110100001110101010010100010001101010010101001101110011111101011011000010111101011001000101000100011010100101010011011100111111000000001011011000100110001100111111111110100000100101011110110010101011011000010100010001001010001111010101111001011001010001100011101000100000100000001111111010101000010011000000011111110101001010001001111111010110001011001111000000110110100011000101100001001111110111101011000111000111111011111101001010001100111111111110100000100101011110111011110001000110101010010000011111010101111001011001010001100011101000101110000001010110101101101101110001010101011011000010000000100010111011000111111010001011100000010101101011011011101100010110101101100001000000010001011101100011111101000101110000001010110101101101101110011010001100010110000110111100111111111110100000100101011110111000101010100010111010101001000001111101010111100101100101000110001111011010010011111111110011100100011100001000001010100001010011011010101111110010100001010001101010011010101011011010000100001110001000010101011011110011100111111111100000001110010001011110111110000010100100010111100011011010110000101100001101101011000010110011100100100010111011000100001100100111111111111111111010010110010101101110101010100101101011111010100111000010010011100111111111111111111100000011010100111011011101101110101010011010110001101101110110110000110111011001110101000011111110100101010111001100010000110010011111111111111111111111111101110110011101010010010010110111010010000011010100111010010101011100110100100101001010101110011001001001010000100100100111111111111111111111111111011101100111010100100100100001110110010100101000110000111010100110011100100101010010001011010111101101011000010110000100100100111111111111111111111111111011101100111010100100100010101100011010110001010001000011011100110110101001100000100011111101000001001110101010011110100101010111001101001000111100010110000001101100101000111000001000001000001001101001001011000111101010100111101001010101110011010010001111000101100000011010011111111111111111111111111101110110011101010010010001010110001101011000101101101010011101110110011101010010010010000111011001010010100011000011001000101011000110101100010110111010110100111011101100111010100100100010101100011010110001010001000011011100110110110011101011101101110000101010010101001011010011100111111111111111111100000011010100110001011001000100000000011011101100111010100001000011001001111111111111111111111111101010110011011101010111001101100111001100011011000110001100100111111111111111111111111111111111110000111101010011001011011110010000010110010001000000000110111011001110101001001001011011101001000000011111101111001000011111101000010010110111100100101001011110001010001000100001101110110011101010010010010110111010010000000100100100101111000110110111011110101010101011000110001111110011100100011100001000001010100001010011011010101111110010100001010000010000100100111111111111111111111111111111111110101101001101001001011000111100001100110010011111111111111111111111111111111111111111110000110001011001000011111011001111111111111111111111111111111111010111000100011101010011101110110011101010010010010000111011001010010100011000011001001000101100111001110000010010010011111111111111111111111111111111111011101100111010100100100100001110110010100101000110000110010010111011001100111110100001100001000011111100111010110010000111111101110110011101010010010010000111011001010010100011000011001000101011000110101100010110000011000011001000011111110111011001110101001001001000011101100101001010001100001100100101110110011001111101000010101110001000100100100111111111111111111111111111011101100111010100100100010010110010101101110101010100101101011111010100111000010010011111111111111111111111111000101101000110110000010100111101110110011101010010010010000111011001010010100011000011001000001011001000100000000010010010011100111111111111111111100000011010100110001011001000100000011101010101001011000001101110110011101010000100001100100111111111111111111111111110101011001101110101011100110111011101100111010100100100010010110010101101110101010100101101011111010100010100111000010000110010011111111111111111111111111111111111000011110101001100101101111001000001011001000100000000011011101100111010100100100101101110100100000001111110111100100001111110100001001011011110010010100101111000101000100010000110111011001110101001001001011011101001000000010010010010111100011011011101111010101010101100011000111111001110010001110000100000101010000101001101101010111111001010000101000001000010010011111111111111111111111111111111111011101100111010100100100010010110010101101110101010100101101011111010100111000011100100000000001011011000100110001000011000011000001000111111001101001000001000010011001110111100001010010010110001111000011001001001111111111111111111111111111111111010111000100011101010011101110110011101010010010010000111011001010010100011000011001001000101100111001110000010010010011111111111111111111111111111111111011101100111010100100100100001110110010100101000110000110010010111011001100111110100001100001000011111100111010110010000111111101110110011101010010010010000111011001010010100011000011001000101011000110101100010110000011000011001000011111110111011001110101001001001000011101100101001010001100001100100101110110011001111101000010101110001000100100100111111111111111111111111111011101100111010100100100010010110010101101110101010100101101011111011111110101001100110101001111111111111111111111111100010110100011011000001010011110111011001110101001001001000011101100101001010001100001100100000101100100010000001110101010100101100000100100100111001111111111111111111000000110101001110100011101011001011100110110000110111011001110101000010000110010011111111111111111111111111101011010011101110110011101010010010001010110001101011000101000100001101110011000110010011111111111111111111111111111111110010110111100100010101100011010110001011000001101110110011101010010010010110111010010000000111111101110110011101010010010010000111011001010010100011000011001000000011011010001011111000100001110101100011000001001000010010011111111111111111111111111111111111011101100111010100100100100001110110010100101000110000110010010001000110110001001000000010001000101100000110000100001000011111110111011001110101001001001000011101100101001010001100001100100101110110011001111101000011000010000100100111001111111111000000011100100010111101111110110101100001011011111100000010100001011010110110000100001101101011000010110011100100100010111011000100001100100111111111111111111100000011010100111011011101101110101010011010110001101101110110110000110111011001110101000011111110100101010111001100010000110010011111111111111111111111111101110110011101010010010010000111011001010010100011000011101010011000001010010001011110001101101011000010110000110100101010111001100010010011111111111111111111111111101110110011101010010010010100011101011001011100110111101010011101110110011101010010010010000111011001010010100011000011001001010001110101100101110011011100111111111111111111111111111011101100111010100100100010101100011010110001010001000011011100110110101001110111011001110101001001001000011101100101001010001100001100100010101100011010110001010001000011011100110100111111111111111111111111111011101100111010100100100010101100011010110001011011010100110111001000011110100001110000001000111011100110011101110110011101010010010010000111011001010010100011000011001000101011000110101100010110000011011110010001100100100000000101100000011000001000001000100010111000000101011010100000100001000010010011111111111111111111111111101110110011101010010010000010110010001000001101010011011100100001111010000111000000100000110011101110110011101010010010010000111011001010010100011000011001000001011001000100000000010010010010010000001100000000010110000001100000100000100010001011100000010101101010000010000100100111111111111111111111111111011101100111010100100100000101100100010000001110101010100101101101010011011100100001111010000111000000100000110011101110110011101010010010010000111011001010010100011000011001000001011001000100000011101010101001011000001001001001001000000110000000001011000000110000010000010001000101110000001010110101000001000010010011100111111111110111010101001011110010010111100011000001010101001110101001110110101100001011011111100000010100001011010110110000100001101110101010010111100100101111000110000010101010010010010011111111111011101010100101111001001011110001100000001011011001000111010100111011010110000101101111110000001010000101101011011000010000110111010101001011110010010111100011000000010110110010001001001001111111111101010100101011101100100011101010011011100100001111010000111000000100000110011101110101010010111100100101111000110000010101010011001000001011001000100000011101010101001011000001001001001000001101111000100011010101011000010000010001111110011000101111110011010010000010000100100111111111110011111111111000000110101001110110101000010010000110010011111111111111111100010110100011011000001010011110101010010101110110010001000010010010011100111111111110000001101010011101101011011010100001001000011001001111111111111111110001011010001101100000101001111010101001100010000110101010010101110110010001000010010000100100111001111111111100000011010100110000010111011010110110101000010010000110010011111111111111111100010110100011011000001010011101111001000010110000110101010011000100111111101010100101011101100100010000100100100100101110101101110101011000100001001000010010011100111111111110000001101010011001110000010110101000010010000110010011111111111111111100010110100011011000001010011101110101011011110001000011010101001010111011001000100001001001001001011101011011101010110001000010010000100100111001111111111100000011010100110011100000101101011011010100001001000011001001111111111111111110001011010001101100000101001110111010101101111000100001011110010000101100001101010100110001001111111010101001010111011001000100001001001001001011101011011101010110001000010010000100001001001110011111111111000000110101001101010101110000010111011010100001001000011001001111111111111111110001011010001101100000101001110111100100001011000010111001000011110100001110000001000110111111010011001110101010011000100001011111101001001101111111110011010001111111010101001010111011001000100001001001001001011101011011101010110001000010010000100100111001111111111100000011010100110011100000010101011100000101110110101000010010000110010011111111111111111100010110100011011000001010011101110101011011110001000010111100100001011000010111001000011110100001110000001000110111111010011001110101010011000100001011111101001001101111111110011010001111111010101001010111011001000100001001001001001011101011011101010110001000010010000100001001001110011111111111010101001101001101010011101000111000101010001000100001001110101010101010011010000111010100010010011100111000001010010111001111110011011010001011100110111010101001000001100111111100011010101111001101010110001110101001100000101001000011101011101100011111100000101001000011101011101100011111100111001100011011000110100111001110101101001110000010100101110011001001111111111101000001001010111101110001010101000101101101011111101010111100101100101000110001110101010111011001001011000010100010001001010001001110011010101000101101101001110011111111111000000110101001110000110010100101100011011110001000101000010110000110100001111111011110001010000000000111110101010010010101001011001000011001001111111111111111111000000110101001101010110001010000101101011011010000010100101100010010000000000110110100010000001000001110111001111111011010010110100011111010101011010000001000001110111001000011001001111111111111111111111111110101101001110111100010100000000001111101001100100111111111111111111111111111111111100010110100011011000001010011110100000011011010001000000100000111011100111111101101001011010001111101010101101000000100000111011100100100111111111111111111111111110110011101011101100011001001111111111111111111111111111111111100010010111010100111010000001101101000100000010000011101110011111110110100101101000111110101010110100000010000011101110010010011111111111111111111111111111111110101011001101110101011100110110011100110001101100011000110010011111111111111111111111111111111111111111110101101001110001010101000101101100000110001001010010011101011011111010101011101100100101100001010001000100101000100111001101010100010110110001100100111111111111111111111111111111111111111111111111111011110001010000000000111110110010001000010110101101100100110000000001100010010100100100111111111111111111111111111111111111111111111111111000100101110101001101001011001111110110001000011000100101001001001111111111111111111111111111111111111111110110011101011101100011001001111111111111111111111111111111111111111111111111110111100010100000000001111101100100010110010101011000010010010011111111111111111111111111111111111111111111111111101011010011010010010110001111011110001010000000000111110100110010011111111111111111111111111111111111111111111111111111111111000011000101100100001111101100111111111111111111111111111111111111111111111111111000100101110101001110111100010100000000001111101100101001111111001101010010111001001011101100100110000000001100010010100100100111111111111111111111111111111111100010110100011011000001010011110001001011001111111111111111110001011010001101100000101001110101011000101000010110101101101000001010010110001001000000100111001110101101001100110110100010111001101110101010010000011001100100111111111100111010010001110100001000010101001110100011000010110000010111101010011000101000010011000000010101111010010000000110110100010001010000100110000010000111010110001101110000100111010111000010000100100111111111100000001110010001011110111110111111000000101000010110101101100001000011010101001100010010000110010011111111111111111110000001101010011101101110110111010101001101011000110110111011011000011011101100111010100001111110111111010010000110010011111111111111111111111111101010100110001100100101101110110111010101001101011000110110111011011000010111111010010010011100111111111111111111100000011010100111011011101101100110110100010111001101110110111011011000011011101100111010100001000011001001111111111111111111111111100010110100011011000001010011110111101100010110110000100001011111100000010100001011010110110000100111111101110110011101010000100100100101101110110110011011010001011100110111011011101101100001001001100111000101011001110100100011101000010000101010011101000110000101100000101110011100111010110100110011100110001101100011000110010011111111111010101111001011001010001100011110001101010111100110100111111111110000001101010011100011010101111001100001000011010010110001001000000001000011001001111111111111111111000000110101001101010110001010000101101011011000010000110110100010000001000001110111001111111011010010110100011111010101011010000001000001110111001000011001001111111111111111111111111110111100010100000011000111010100111000110101011110011010010010001101010111100110000010010010011111111111111111111111111000101101011110110001110100011101010011101001011000100100000000001101101000100000010000011101110011111110110100101101000111110101010110100000010000011101110010010011111111111111111111111111011001001100000110101001110001101010111100110100100100011010101111001100000100100100111111111111111111111111110101100011010101001100010000110100001110101000111001110101011110011011001110000110111011010000000110011001110001011000100101101100010011000000000100001011001001100000110111111111101111000101000000110001001001110110100110011010100001001000010010000100001000101010110101101111010111001110101000100100111111111111111111111111110001011010001101100000101001110001011010111101100011101000110011111111111111111100010110100011011000001010011101010110001010000101101011011000011110101101001110001101010111100110101011000111011001110101110110111010010110001001000000100111001101001001111110111110111010100110000010111011010110110101000010010010011010011011000111101011111010100110011100000010101011100000101110110101000010010010011100110101100010110011111001101010011100101001111111001101010010111110110100110100110011101111011001010010100110101001110010101010101001101001001011111011010011010011001110011010110010110111110101001110010100111111100110101001011111011010011010011001110100001010001111010111101010100111000101000010010000011011000001010010010000110010011111111110101100010110011111001001010101011001011110101001101011001011011110010100100110110001111010111100101010101100101110010111001111111111010110010110111100101001001101100011110101111001010101011001011100101111010100111010110011100110101100101101111101010011100101010101010011010010010111110110100110100110011101000010100011110101111010101001110001010000100100000110110000010100101111111001101000111111011111110011010001111110111111100110100010000110010011111111111011110110010100101001001010101011001011110101001101011001011011110010100100110110001111010111100101010101100101110010111001111111111010110010110111100101001001101100011110101111001010101011001011100101111010100111010110011100111000000101111010100111001010100001001001011111011010011000010100111001110111100110100010010011101000010100011110101111010101001110001010000100100000110110000010100100100001100100111111111110000001011100101010101001110110011010100101111010100111000000101110010101010110010111001111111111101011010011010110001011001111100100101010101100101111001110001110101001110000100001100100111111111111111111100000010111001010101010011101100110101001011110011101101010011101011101111111110101100010110011111001001010101011001011100111001101111100110101001100110101101010101001010101011010011001001000011101011000110110110111001100100100000111000100110110000100100110111111111001101010011100111010000101000111101101111101010100111000101000010010000011011000001011111011101111111110011010001000011001001111111111010010110010101110110111000000101111010100111001010100001010100101010010110100101111101101001100001010011100111011110011010001001001111111111101000001001010111101011011010110010110111110101001110010101000010101001010100101101001011111011010011000010100111001110111100110100010010011111111110100101100101011101101110000001011100101010000100100101111010100111000010010011111111111010000010010101111010110110101100101101111001010100001001001011110101001110000100100111111111110011111111111000101111001011110101001101111100100111111111101010110011011101010111001101110001011110010110011001001111111111111111110000001011000001001111110101101110001111110101100011101010011100001000011111110000100001111111000010010011111111111111111101111100010000111010111110101001101110101011011110001000010001010000100100000110110000011000010000111111010011100111011110011010001111111000101111001011001000010010011111111111111111110100001010001111010111101010100111000101000010010000011011000001001101000111111011100110010010000101111100010000111010111001000010000110010011111111111111111111111111101011010011010010110010101110110111000000101110010100111110001000011101011110010101010110010111001011111010110111110100100101100011110000101010010101001011000110011000000001010100110001101010100110110001101001111111111111111111111111101110011010100100011101010011101000001001010111101011011010110010110111100101001111100010000111010111100101010101011111110011010100101110010111001111111111111111111111111100011010100000110011011100011101010011011110101010100100001011111000100001110101111001010101011001011110111111111001101000111111101000001001010111101011011010110010110111100101001111100010000111010111100101010101001110110011010100101110010110010011101011010011101011100111011110011010110101010101101110011001001000010111110001000011101011100100110110011101011101101101111100010000111010111100101010101100101111011111111100110101001111111111111111111111111110011111111111111111111111111010101100110111010101110011011010110001110101010101101111100010000111010111100101010101100101111011111111100110100011001001111111111111111111111111111111111010110001110011101101010011001101010011111111111111111111111111111111111010110100110101100010110011111001001010010110001100101111001110001110101001101011011100011001001111111111111111111111111111111111111111110000001011000001110011101101010011010110001110111111111010110001011001111100100101001011000110010111001111111111111111111111111110011111111111111111111111111010101100110111010101110011011010110111011010101010110111001101010010001001100100111111111111111111111111111111111110101101001110111101100101001010010010100101101110100101111010101010010100110101100010011001001111111111111111111111111111111111111111110000001011000001110111111101010011101111011001010010100100101001011011101001011110111111111010110111010011111111111111111111111111111111110101101110110011101101010011001101010011111111111111111111111111100111111111111111111111111110101100111111000101101011111010100110101101110001111110000001011000001110011101111100000010111001010010110111010010111001111111111111111111111111101010110011011101010111001101101011011101101010101011000110101000001100110111000100110010011111111111111111111111111111111111010110100111011110110010100101001001010010110111010010111101010101001010011010110001001100100111111111111111111111111111111111111111111000000101100000111011111110101001110111101100101001010010010100101101110100101111011111111101011011101001111111111111111111111111111111111010110111011001110110101001100110101001111111111111111111111111111111111101011010011000000101100000111001110111110000001011100101001011011101001011110101010101100010110101110011001001111111111111111111111111111111111111111110101100111111000101101011111010100110101101110001111110000001011000001110011101111100000010111001010010110111010010111001111111111111111111111111110011111111111111111111111111010010110010101110110111000000101110010100111110001000011101011110010101010110010111001011110101001100010110101111001111111111111111111111111110100000100101011110101101101011001011011110010100111110001000011101011110010101010110010111001011110101001101011100111111111111111111100111111111111111111100010111100101111001110001100011100011001010011001110101110011111111111000000101111010100110100101100101011101101110000001011100110101100011010101001100010000110000001011100101001001100101100100

Decodificación del Código Huffman: 
if True:
    from io import BytesIO, IOBase
    import math

    import random
    import sys
    import os

    import bisect
    import typing
    from collections import Counter, defaultdict, deque
    from copy import deepcopy
    from functools import cmp_to_key, lru_cache, reduce
    from heapq import heapify, heappop, heappush, heappushpop, nlargest, nsmallest
    from itertools import accumulate, combinations, permutations, count
    from operator import add, iand, ior, itemgetter, mul, xor
    from string import ascii_lowercase, ascii_uppercase, ascii_letters
    from typing import *
    BUFSIZE = 4096

    class FastIO(IOBase):
        newlines = 0

        def __init__(self, file):
            self._fd = file.fileno()
            self.buffer = BytesIO()
            self.writable = "x" in file.mode or "r" not in file.mode
            self.write = self.buffer.write if self.writable else None

        def read(self):
            while True:
                b = os.read(self._fd, max(os.fstat(self._fd).st_size, BUFSIZE))
                if not b:
                    break
                ptr = self.buffer.tell()
                self.buffer.seek(0, 2), self.buffer.write(b), self.buffer.seek(ptr)
            self.newlines = 0
            return self.buffer.read()

        def readline(self):
            while self.newlines == 0:
                b = os.read(self._fd, max(os.fstat(self._fd).st_size, BUFSIZE))
                self.newlines = b.count(b"\n") + (not b)
                ptr = self.buffer.tell()
                self.buffer.seek(0, 2), self.buffer.write(b), self.buffer.seek(ptr)
            self.newlines -= 1
            return self.buffer.readline()

        def flush(self):
            if self.writable:
                os.write(self._fd, self.buffer.getvalue())
                self.buffer.truncate(0), self.buffer.seek(0)

    class IOWrapper(IOBase):
        def __init__(self, file):
            self.buffer = FastIO(file)
            self.flush = self.buffer.flush
            self.writable = self.buffer.writable
            self.write = lambda s: self.buffer.write(s.encode("ascii"))
            self.read = lambda: self.buffer.read().decode("ascii")
            self.readline = lambda: self.buffer.readline().decode("ascii")

    sys.stdin = IOWrapper(sys.stdin)
    sys.stdout = IOWrapper(sys.stdout)
    input = lambda: sys.stdin.readline().rstrip("\r\n")
    
    def I():
        return input()

    def II():
        return int(input())

    def MII():
        return map(int, input().split())

    def LI():
        return list(input().split())

    def LII():
        return list(map(int, input().split()))

    def GMI():
        return map(lambda x: int(x) - 1, input().split())

    def LGMI():
        return list(map(lambda x: int(x) - 1, input().split()))

    inf = float('inf')

dfs, hashing, timeit = False, False, True

if dfs:
    from types import GeneratorType

    def bootstrap(f, stack=[]):
        def wrappedfunc(*args, **kwargs):
            if stack:
                return f(*args, **kwargs)
            else:
                to = f(*args, **kwargs)
                while True:
                    if type(to) is GeneratorType:
                        stack.append(to)
                        to = next(to)
                    else:
                        stack.pop()
                        if not stack:
                            break
                        to = stack[-1].send(to)
                return to
        return wrappedfunc

if hashing:
    RANDOM = random.getrandbits(20)
    class Wrapper(int):
        def __init__(self, x):
            int.__init__(x)

        def __hash__(self):
            return super(Wrapper, self).__hash__() ^ RANDOM

if True:
    import time
    def timer(func):
        def wrapper(*args, **kwargs):
            start = time.time()
            result = func(*args, **kwargs)
            end = time.time()
            print(f'Time Used: {round((end - start) * 1000)} ms')
            return result
        return wrapper if timeit else func

n, k = MII()
nums = LGMI()

prev = [-1] * n
suff = [inf] * n

pos = [-1] * n
for i in range(n):
    prev[i] = pos[nums[i]]
    pos[nums[i]] = i

pos = [inf] * n
for i in range(n-1, -1, -1):
    suff[i] = pos[nums[i]]
    pos[nums[i]] = i

dp = [0] * (n + 1)
for i in range(n):
    dp[i+1] = dp[i]
    if prev[i] >= 0:
        dp[i+1] += i - prev[i]

v = 1 << n.bit_length() - 1

for _ in range(k - 1):
    new_dp = [None] * (n + 1)
    from_pos = [None] * (n + 1)
    new_dp[0] = 0
    from_pos[0] = 0
    
    tmp = v
    while tmp:
        cur, pl, pr = 0, 0, 0
        vals = list(range(0, n + 1, tmp))
        for i in range(1, len(vals)):
            if new_dp[vals[i]] is not None: continue
            left = from_pos[vals[i-1]]
            right = min(vals[i] - 1, from_pos[vals[i+1]]) if i + 1 < len(vals) else vals[i] - 1
            
            while pr < vals[i] - 1:
                pr += 1
                if prev[pr] >= pl:
                    cur += pr - prev[pr]
            
            while pl < left:
                if suff[pl] <= pr:
                    cur -= suff[pl] - pl
                pl += 1
            
            p, res = pl, cur + dp[pl]
            while pl < right:
                if suff[pl] <= pr:
                    cur -= suff[pl] - pl
                pl += 1
                if cur + dp[pl] < res:
                    p, res = pl, cur + dp[pl]
            
            new_dp[vals[i]] = res
            from_pos[vals[i]] = p
        
        tmp //= 2
    dp = new_dp
print(dp[n])

Peso de la cadena original: 44736 bits
Peso de la cadena comprimida: 24087 bits
Tiempo de compresión: 1297.73 microsegundos (promedio de 100 iteraciones)
Tiempo de descompresión: 419.83 microsegundos (promedio de 100 iteraciones)
